modules-y += ncurses

ncurses_depends := $(musl_dep)

ncurses_version := 6.5
ncurses_dir := ncurses-$(ncurses_version)
ncurses_tar := ncurses-$(ncurses_version).tar.gz
ncurses_url := https://invisible-island.net/archives/ncurses/ncurses-$(ncurses_version).tar.gz
ncurses_hash := 136d91bc269a9a5785e5f9e980bc76ab57428f604ce3e5a5a90cebc767971cc6

ncurses_configure := \
	CFLAGS="-Os" ./configure \
	$(CROSS_TOOLS) \
	--host $(MUSL_ARCH)-elf-linux \
	--without-ada \
	--without-cxx \
	--without-cxx-binding \
	--without-manpages \
	--without-shared

# Build and install ncurses data
ncurses_target := $(MAKE_JOBS) \
	$(CROSS_TOOLS) \
	DESTDIR="$(INSTALL)" \
	install.data


# Dynamically register terminfo files for inclusion in data.cpio with the correct relative path
$(info DEBUG: Registering terminfo file for data.cpio: usr/share/terminfo/l/linux -> etc/terminfo/l/linux)
data_files += usr/share/terminfo/l/linux|etc/terminfo/l/linux
$(info modules/ncurses: data_files after registration: $(data_files))

